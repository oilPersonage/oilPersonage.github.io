"use strict";(self["webpackChunkautoinline"]=self["webpackChunkautoinline"]||[]).push([[477],{8882:(e,t,i)=>{i.d(t,{Z:()=>z});i(71);var a=i(3673),l=i(8880);const n={class:"addCity__content row"},o={class:"addCity__input"},s={class:"addCity__input"},d={class:"addCity__input"},u={class:"addCity__input"},g={class:"modal__buttons row"};function p(e,t,i,p,c,r){const m=(0,a.up)("AiSelect"),h=(0,a.up)("AiInput"),b=(0,a.up)("AiButton"),y=(0,a.up)("AiModal");return(0,a.wg)(),(0,a.j4)(y,{open:e.open,title:e.modelTitle,isSave:"",onToggleOpen:e.toggleOpen},{default:(0,a.w5)((()=>[(0,a._)("form",{onSubmit:t[4]||(t[4]=(0,l.iM)(((...t)=>e.onSubmit&&e.onSubmit(...t)),["prevent"]))},[(0,a._)("div",n,[(0,a._)("div",o,[(0,a.Wm)(m,{options:e.cityList,selectValue:e.data.title,label:"Город",name:"city",required:"","onUpdate:selectValue":t[0]||(t[0]=t=>e.updateValue("title",t))},null,8,["options","selectValue"])]),(0,a._)("div",s,[(0,a.Wm)(m,{options:e.regionList,selectValue:e.data.region_id,label:"Регион",name:"region",required:"","onUpdate:selectValue":t[1]||(t[1]=t=>e.updateValue("region_id",t))},null,8,["options","selectValue"])]),(0,a._)("div",d,[(0,a.Wm)(m,{options:e.timezoneList,selectValue:e.data.timezone,label:"Часовой пояс","onUpdate:selectValue":t[2]||(t[2]=t=>e.updateValue("timezone",t))},null,8,["options","selectValue"])]),(0,a._)("div",u,[(0,a.Wm)(h,{value:e.data.slug,"onUpdate:value":t[3]||(t[3]=t=>e.data.slug=t),name:"slug",required:"",title:"Поддомен"},null,8,["value"])])]),(0,a._)("div",g,[(0,a.Wm)(b,{isSave:"",size:"big",text:"Сохранить",type:"submit"})])],32)])),_:1},8,["open","title","onToggleOpen"])}var c=i(6440),r=i.n(c),m=i(3617),h=i(3373),b=i(2337),y=i(4434),_=i(7931);const C=(0,a.aZ)({name:"Modal",components:{AiSelect:_.Z,AiInput:b.Z,AiModal:h.Z},props:{open:{type:Boolean},toggleOpen:{type:Function},tableData:{default:null}},data(){return{data:{title:"",region_id:"",timezone:r().tz.guess(),slug:""}}},watch:{tableData(){this.data={...this.tableData}}},computed:{...(0,m.Se)({cityL:"cities/getCities",regionList:"cities/getRegions",timezoneList:"cities/getTimezones"}),modelTitle(){return this.tableData?`Редактирование города - ${this.tableData.title}`:"Добавление города"},cityList(){return this.cityL.map((e=>e.title))}},methods:{...(0,m.nv)({postCity:"cities/postCity",updateCity:"cities/updateCity"}),updateValue(e,t){this.data[e]=t},async onSubmit(){if(/^[a-z0-9]+(?:-[a-z0-9]+)*$/.test(this.data.slug)){const e={...this.data,timezone:this.data.timezone.id||this.data.timezone,title:this.data.title,region_id:this.data.region_id.id};this.tableData?await this.updateCity(e):await this.postCity(e),this.toggleOpen(),this.data={title:"",region_id:"",timezone:r().tz.guess(),slag:""}}else y.Z.create({message:'Поле "Поддомен" не соответстует требованию.'})}}});var f=i(4260);const v=(0,f.Z)(C,[["render",p],["__scopeId","data-v-4cedeab6"]]),z=v},3477:(e,t,i)=>{i.r(t),i.d(t,{default:()=>b});var a=i(3673);function l(e,t,i,l,n,o){const s=(0,a.up)("AiFilters"),d=(0,a.up)("Table");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(s,{filterCities:""}),(0,a.Wm)(d)],64)}function n(e,t,i,l,n,o){const s=(0,a.up)("AiTable"),d=(0,a.up)("ModalContent");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(s,{data:e.dataTable,loading:e.isLoadAll,onChangeItem:e.onChange,onDelete:e.onDelete},null,8,["data","loading","onChangeItem","onDelete"]),(0,a.Wm)(d,{open:e.open,tableData:e.data,toggleOpen:e.toggleOpen},null,8,["open","tableData","toggleOpen"])],64)}var o=i(3617);const s=[{name:"city",required:!0,label:"Город",align:"left",field:"label",format:e=>`${e}`,style:"width: 30%"},{name:"region",align:"left",label:"Регион",field:"region",format:e=>e.title,style:"width: 40%"},{name:"timezone",label:"Часовой пояс",field:"timezone",align:"left",style:"width: 10%"},{name:"slug",label:"Поддомен",field:"slug",align:"left",style:"width: 10%"},{name:"action",label:"Action",field:"action",style:"width: 98px",align:"center"}];var d=i(8882),u=i(7923);const g=(0,a.aZ)({name:"СityTable",components:{AiTable:u.Z,ModalContent:d.Z},data(){return{open:!1,data:null}},computed:{...(0,o.Se)({cities:"cities/getCities",isLoadAll:"cities/isLoadAll"}),dataTable(){return{columns:s,rows:this.cities}}},methods:{...(0,o.nv)({onDelete:"cities/deleteCity",getCities:"cities/getCities",getRegions:"cities/getRegions"}),toggleOpen(){this.open=!this.open,this.data=null},onChange(e){this.getRegions(),this.data={title:e.title,region_id:{id:e.region.id,label:e.region.title},slug:e.slug,timezone:e.timezone,id:e.id},this.open=!this.open}},mounted(){this.getCities()}});var p=i(4260);const c=(0,p.Z)(g,[["render",n]]),r=c,m=(0,a.aZ)({name:"City",components:{Table:r}}),h=(0,p.Z)(m,[["render",l]]),b=h}}]);
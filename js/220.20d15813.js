"use strict";(self["webpackChunkautoinline"]=self["webpackChunkautoinline"]||[]).push([[220],{1477:(e,t,i)=>{i.d(t,{Z:()=>z});i(71);var a=i(3673),l=i(8880);const n={class:"addCity__content row"},s={class:"addCity__input"},o={class:"addCity__input"},d={class:"addCity__input"},u={class:"addCity__input"},g={class:"modal__buttons row"};function p(e,t,i,p,r,c){const m=(0,a.up)("AiInput"),h=(0,a.up)("AiSelect"),b=(0,a.up)("AiButton"),_=(0,a.up)("AiModal");return(0,a.wg)(),(0,a.j4)(_,{open:e.open,title:e.modelTitle,isSave:"",onToggleOpen:e.toggleOpen},{default:(0,a.w5)((()=>[(0,a._)("form",{onSubmit:t[5]||(t[5]=(0,l.iM)(((...t)=>e.onSubmit&&e.onSubmit(...t)),["prevent"]))},[(0,a._)("div",n,[(0,a._)("div",s,[(0,a.Wm)(m,{value:e.data.title,"onUpdate:value":t[0]||(t[0]=t=>e.data.title=t),title:"Город",name:"city",required:"","onUpdate:selectValue":t[1]||(t[1]=t=>e.updateValue("title",t))},null,8,["value"])]),(0,a._)("div",o,[(0,a.Wm)(h,{options:e.regionList,selectValue:e.data.region_id,label:"Регион",name:"region",required:"","onUpdate:selectValue":t[2]||(t[2]=t=>e.updateValue("region_id",t))},null,8,["options","selectValue"])]),(0,a._)("div",d,[(0,a.Wm)(h,{options:e.timezoneList,selectValue:e.data.timezone,label:"Часовой пояс","onUpdate:selectValue":t[3]||(t[3]=t=>e.updateValue("timezone",t))},null,8,["options","selectValue"])]),(0,a._)("div",u,[(0,a.Wm)(m,{value:e.data.slug,"onUpdate:value":t[4]||(t[4]=t=>e.data.slug=t),name:"slug",required:"",title:"Поддомен"},null,8,["value"])])]),(0,a._)("div",g,[(0,a.Wm)(b,{isSave:"",size:"big",text:"Сохранить",type:"submit"})])],32)])),_:1},8,["open","title","onToggleOpen"])}var r=i(6440),c=i.n(r),m=i(3617),h=i(2008),b=i(2337),_=i(4434),y=i(4962);const f=(0,a.aZ)({name:"Modal",components:{AiSelect:y.Z,AiInput:b.Z,AiModal:h.Z},props:{open:{type:Boolean},toggleOpen:{type:Function},tableData:{default:null}},data(){return{data:{title:"",region_id:"",timezone:c().tz.guess(),slug:""}}},watch:{tableData(){this.data={...this.tableData}}},computed:{...(0,m.Se)({cityL:"cities/getCities",regionList:"cities/getRegions",timezoneList:"cities/getTimezones"}),modelTitle(){return this.tableData?`Редактирование города - ${this.tableData.title}`:"Добавление города"},cityList(){return this.cityL.map((e=>e.title))}},methods:{...(0,m.nv)({postCity:"cities/postCity",updateCity:"cities/updateCity"}),updateValue(e,t){this.data[e]=t},async onSubmit(){if(/^[a-z0-9]+(?:-[a-z0-9]+)*$/.test(this.data.slug)){const e={...this.data,timezone:this.data.timezone.id||this.data.timezone,title:this.data.title,region_id:this.data.region_id.id};this.tableData?await this.updateCity(e):await this.postCity(e),this.toggleOpen(),this.data={title:"",region_id:"",timezone:c().tz.guess(),slag:""}}else _.Z.create({message:'Поле "Поддомен" не соответстует требованию.'})}}});var C=i(4260);const v=(0,C.Z)(f,[["render",p],["__scopeId","data-v-76d51e65"]]),z=v},1220:(e,t,i)=>{i.r(t),i.d(t,{default:()=>b});var a=i(3673);function l(e,t,i,l,n,s){const o=(0,a.up)("AiFilters"),d=(0,a.up)("Table");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(o,{filterCities:""}),(0,a.Wm)(d)],64)}function n(e,t,i,l,n,s){const o=(0,a.up)("AiTable"),d=(0,a.up)("ModalContent");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(o,{data:e.dataTable,loading:e.isLoadAll,onChangeItem:e.onChange,onDelete:e.onDelete},null,8,["data","loading","onChangeItem","onDelete"]),(0,a.Wm)(d,{open:e.open,tableData:e.data,toggleOpen:e.toggleOpen},null,8,["open","tableData","toggleOpen"])],64)}var s=i(3617);const o=[{name:"city",required:!0,label:"Город",align:"left",field:"label",format:e=>`${e}`,style:"width: 40%"},{name:"region",align:"left",label:"Регион",field:"region",format:e=>e.title,style:"width: 40%"},{name:"timezone",label:"Часовой пояс",field:"timezone",align:"left",style:"width: 10%"},{name:"slug",label:"Поддомен",field:"slug",align:"left",style:"width: 10%"},{name:"action",label:"Action",field:"action",style:"width: 98px",align:"center"}];var d=i(1477),u=i(4854);const g=(0,a.aZ)({name:"СityTable",components:{AiTable:u.Z,ModalContent:d.Z},data(){return{open:!1,data:null}},computed:{...(0,s.Se)({filters:"filters/getFilter",cities:"cities/getCities",isLoadAll:"cities/isLoadAll"}),dataTable(){let e=this.cities;return this.filters.length>0&&(e=this.cities.filter((e=>this.filters.some((t=>t.id===e.id))))),{columns:o,rows:e}}},methods:{...(0,s.nv)({onDelete:"cities/deleteCity",getCities:"cities/getCities",getRegions:"cities/getRegions"}),toggleOpen(){this.open=!this.open,this.data=null},onChange(e){this.getRegions(),this.data={title:e.title,region_id:{id:e.region.id,label:e.region.title},slug:e.slug,timezone:e.timezone,id:e.id},this.open=!this.open}},mounted(){this.getCities(!0)}});var p=i(4260);const r=(0,p.Z)(g,[["render",n]]),c=r,m=(0,a.aZ)({name:"City",components:{Table:c}}),h=(0,p.Z)(m,[["render",l]]),b=h}}]);